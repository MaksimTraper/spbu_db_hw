# Домашнее задание №3
## Задания
1.  Создайте временную таблицу high_sales_products, которая будет содержать продукты, проданные в количестве более 10 единиц за последние 7 дней.
    Выведите данные из таблицы high_sales_products.

2. Создайте CTE employee_sales_stats, который посчитает общее количество продаж и среднее количество продаж для каждого сотрудника за последние 30 дней.
    Напишите запрос, который выводит сотрудников с количеством продаж выше среднего по компании.

3. Используя CTE, создайте иерархическую структуру, показывающую всех сотрудников, которые подчиняются конкретному менеджеру.
    Напишите запрос с CTE, который выведет топ-3 продукта по количеству продаж за текущий месяц и за прошлый месяц. В результатах должно быть указано, к какому месяцу относится каждая запись.

4. Создайте индекс для таблицы sales по полю employee_id и sale_date, чтобы ускорить запросы, которые фильтруют данные по сотрудникам и датам.
   Проверьте, как наличие индекса влияет на производительность следующего запроса, используя EXPLAIN ANALYZE.

5. Используя EXPLAIN, проанализируйте запрос, который находит общее количество проданных единиц каждого продукта.

Основной код, выполняющий ТОЛЬКО условия задания, хранится в файле hw3.sql

В папке additional_files есть отдельные файлы по каждому заданию. Также, ради собственного любопытства и некоторой глупости сделал небольшой Python скрипт с взаимодействие БД через psycopg2. Использовал для генерации данных в начале работы. Далее, в 4 задании, уже применю другую методику генерации с помощью внутренних инструментов SQL.